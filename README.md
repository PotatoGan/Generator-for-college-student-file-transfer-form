# 📁 高校毕业生档案转递文档批量生成工具

一个基于Python和PyQt6开发的批量文档生成工具，专门用于高校毕业生档案转递文档的自动化生成。

## ✨ 功能特点

- 📊 **Excel批量导入**：支持从Excel文件批量导入学生信息
- 📝 **Word文档生成**：基于模板自动生成标准化的档案转递文档
- ✏️ **实时编辑**：支持在表格中直接编辑数据，所见即所得
- 🔄 **自动转档字号**：自动生成转档字号（年份后两位+学号_班级）
- 📅 **日期智能提取**：自动从日期字段提取年、月、日信息
- 🎯 **缺失字段补全**：智能检测缺失字段并提供补全对话框
- 👆 **手动填写模式**：支持单个文档的手动信息填写和生成

## 📂 项目结构

```
├── Generator-for-college-student-file-transfer-form.py                    # 主程序文件
├── template/                                                              # Word模板文件夹
│   └── 20230914-高等学校毕业生档案转递告知书（适用于2023届及以后）模板.docx   # Word模板文件（包含占位符）
├── build.bat                                                              # Windows一键打包脚本
├── 高校毕业生档案转递信息样例.xlsx                                          # Excel数据样例文件
├── LICENSE                                                                # 开源协议文件
└── README.md                                                              # 本说明文档
```

## 🚀 快速开始

### 环境要求

- Python 3.8 或更高版本
- Windows/Linux/MacOS 操作系统

### 安装依赖

```bash
# 克隆仓库
git clone [仓库地址]
cd [项目文件夹]

# 安装必要的Python包
pip install pandas numpy python-docx PyQt6 openpyxl
```

### 运行程序

```bash
python Generator-for-college-student-file-transfer-form.py
```

## 📖 使用说明

### 1. 准备Word模板

在 `template` 文件夹中放置Word模板文件（.docx格式），模板中使用 `{{字段名}}` 作为占位符。

常用占位符示例：
- `{{姓名}}` - 学生姓名
- `{{学号}}` - 学生学号
- `{{班级}}` - 班级名称
- `{{年}}`、`{{月}}`、`{{日}}` - 日期信息
- `{{转档字号}}` - 自动生成的转档编号
- `{{身份证号}}` - 身份证号码
- `{{收档单位名称}}` - 接收档案的单位
- `{{档案转递类型}}` - 转递类型（转回生源地/签约单位接收/托管单位接收/升学外校接收）

### 2. 准备Excel数据

参考 `高校毕业生档案转递信息样例.xlsx` 文件格式，准备包含学生信息的Excel文件。

Excel文件应包含以下列（根据模板需要）：
- 姓名、学号、班级（必需）
- 提交时间/日期（可选，程序会自动提取年月日）
- 其他模板中需要的字段

### 3. 批量生成文档

1. 点击"📁 读取Excel文件"导入数据
2. 在表格中检查/编辑数据（双击单元格可编辑）
3. 勾选需要生成文档的记录
4. 点击"📄 批量生成Word文档"
5. 选择输出文件夹
6. 等待生成完成

### 4. 手动填写模式

1. 切换到"手动填写生成"标签页
2. 填写必要信息（姓名、学号、班级为必填）
3. 点击"📄 生成Word文档"
4. 选择输出文件夹

## 📦 打包为EXE

### 方法一：使用提供的批处理文件（推荐）

直接双击运行 `build.bat` 文件，将自动完成打包过程。

### 方法二：手动打包

```bash
# 安装打包工具
pip install pyinstaller

# 执行打包命令
pyinstaller --onefile --windowed --name="档案转递文档生成工具" --add-data="template;template" Generator-for-college-student-file-transfer-form.py
```

打包完成后，可执行文件位于 `dist` 文件夹中。

### 注意事项

- 打包后需要将 `template` 文件夹复制到exe文件同目录
- 首次运行可能被杀毒软件误报，添加信任即可
- 打包后文件大小约100-200MB（包含Python运行环境）

## 🛠️ 技术栈

- **Python 3.8+** - 主要开发语言
- **PyQt6** - GUI界面框架
- **pandas** - Excel数据处理
- **python-docx** - Word文档生成
- **openpyxl** - Excel文件读写

## 📄 文件说明

| 文件名 | 说明 |
|--------|------|
| Generator-for-college-student-file-transfer-form.py | 主程序文件，包含所有功能逻辑 |
| template/ | Word模板文件夹，存放档案转递文档模板 |
| build.bat | Windows批处理文件，一键打包成exe |
| 高校毕业生档案转递信息样例.xlsx | Excel数据格式示例，可作为参考 |
| LICENSE | MIT开源协议 |

## 🎯 功能特性

- ✅ Excel数据批量导入
- ✅ 自动提取日期信息（年/月/日）
- ✅ 自动生成转档字号
- ✅ 表格内实时编辑
- ✅ 缺失字段智能补全
- ✅ 批量文档生成
- ✅ 进度条显示
- ✅ 手动单个生成
- ✅ 档案转递类型下拉选择
- ✅ 详细的使用说明

## ⚠️ 注意事项

1. **模板格式**：确保Word模板中的占位符格式为 `{{字段名}}`
2. **文件命名**：生成的文件名格式为 `学号_姓名_班级.docx`
3. **年份处理**：文档中显示完整年份（如2025），转档字号使用后两位（如25）
4. **编码问题**：确保Excel文件使用UTF-8编码，避免中文乱码

## 🤝 贡献

欢迎提交Issue和Pull Request！

## 📝 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件
